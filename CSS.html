<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/CSS/style.css">
    <title>CSS Kommando Huskeliste</title>
    <link rel="icon" href="./Assets/Logo.png" type="image/png">
</head>
<body class="app-bg">
    <a href="index.html" class="back-link" id="back-link">&larr; Tilbake</a>
    <h1 id="page-title">CSS Kommando Huskeliste</h1>
    <label for="lib-select" style="font-weight:bold; color:rgb(41, 219, 219);">Velg kategori:</label>
    <select id="lib-select">
        <option value="alle">Alle</option>
        <option value="velgelementer">Velgelementer</option>
        <option value="grunnleggende">Grunnleggende</option>
        <option value="layout">Layout</option>
        <option value="media">Media</option>
        <option value="animasjon">Animasjon</option>
        <option value="pseudo">Pseudo</option>
        <option value="gridflex">Grid & Flexbox</option>
        <option value="variabler">Variabler</option>
        <option value="transisjon">Transisjon</option>
        <option value="avanserte">Avanserte</option>
        <option value="bordershadow">Border & Shadow</option>
        <option value="filter">Filter</option>
        <option value="typografi">Typografi</option>
        <option value="bakgrunn">Bakgrunn</option>
        <option value="boxmodel">Box Model</option>
        <option value="effekter">Effekter</option>
    </select>
    <button id="search-icon" aria-label="Søk" class="search-icon-btn">
        <span id="search-svg" class="search-svg">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
        </span>
    </button>
    <input type="text" id="search-input" placeholder="Søk etter CSS..." class="search-input" style="display:none;">
    <div id="categories-container"></div>
    <footer>
    &copy; TheFrostBunny | <a href="https://github.com/TheFrostBunny" target="_blank" rel="noopener" class="github-link">GitHub</a>
</footer>
    <script src="/Javascript/script.js"></script>
    <script>
fetch('./Lister/CSS.json')
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById('categories-container');
        const libSelect = document.getElementById('lib-select');

        function getCategoryLibrary(cat) {
            const libs = [
                'velgelementer','grunnleggende','layout','media','animasjon','pseudo',
                'gridflex','variabler','transisjon','avanserte','bordershadow','filter',
                'typografi','bakgrunn','boxmodel','effekter'
            ];
            for (const lib of libs) {
                if (cat.name && cat.name.toLowerCase().replace(/[^a-z]/g,'').includes(lib)) return lib;
            }
            return 'grunnleggende';
        }

        function renderCategories(selectedLib, searchText) {
            container.innerHTML = '';
            const search = (searchText || '').toLowerCase();
            data.categories.forEach((cat, catIdx) => {
                const catLib = getCategoryLibrary(cat);
                if (selectedLib !== 'alle' && catLib !== selectedLib) return;
                // Søk: filtrer bort kategorier uten treff
                let commands = cat.commands;
                if (search) {
                    commands = commands.filter(cmd =>
                        (cmd.syntax && cmd.syntax.toLowerCase().includes(search)) ||
                        (cmd.description && cmd.description.toLowerCase().includes(search)) ||
                        (cmd.details && cmd.details.join(' ').toLowerCase().includes(search)) ||
                        (cmd.example && cmd.example.toLowerCase().includes(search))
                    );
                    if (commands.length === 0 && !(cat.name && cat.name.toLowerCase().includes(search))) return;
                }
                const catDiv = document.createElement('div');
                catDiv.className = 'category';
                const catTitle = document.createElement('h2');
                catTitle.id = `cat-${catIdx}-title`;
                catTitle.textContent = cat.name;
                catDiv.appendChild(catTitle);

                commands.forEach((cmd, cmdIdx) => {
                    const cmdDiv = document.createElement('div');
                    cmdDiv.className = 'command';

                    const code = document.createElement('code');
                    code.id = `cmd-${catIdx}-${cmdIdx}-syntax`;
                    code.textContent = cmd.syntax;
                    cmdDiv.appendChild(code);

                    const desc = document.createElement('div');
                    desc.className = 'description';
                    desc.id = `cmd-${catIdx}-${cmdIdx}-desc`;
                    desc.textContent = cmd.description;
                    cmdDiv.appendChild(desc);

                    const detailsDiv = document.createElement('div');
                    detailsDiv.className = 'details';

                    const detailsTitle = document.createElement('h3');
                    detailsTitle.id = `cmd-${catIdx}-${cmdIdx}-details-title`;
                    detailsTitle.textContent = cmd.detailsTitle || 'Detaljert Forklaring';
                    detailsDiv.appendChild(detailsTitle);

                    const ul = document.createElement('ul');
                    ul.id = `cmd-${catIdx}-${cmdIdx}-details-list`;
                    (cmd.details || []).forEach(d => {
                        const li = document.createElement('li');
                        li.innerHTML = d;
                        ul.appendChild(li);
                    });
                    detailsDiv.appendChild(ul);

                    const exampleTitle = document.createElement('h3');
                    exampleTitle.id = `cmd-${catIdx}-${cmdIdx}-example-title`;
                    exampleTitle.textContent = cmd.exampleTitle || 'Eksempel';
                    detailsDiv.appendChild(exampleTitle);

                    const pre = document.createElement('pre');
                    pre.id = `cmd-${catIdx}-${cmdIdx}-example`;
                    pre.textContent = cmd.example;
                    const copyButton = document.createElement('button');
                    copyButton.className = 'copy-btn';
                    copyButton.textContent = 'Kopier';
                    copyButton.addEventListener('click', function(event) {
                        event.stopPropagation();
                        navigator.clipboard.writeText(cmd.example).then(function() {
                            copyButton.textContent = 'Kopiert!';
                            setTimeout(function() {
                                copyButton.textContent = 'Kopier';
                            }, 2000);
                        }).catch(function() {
                            copyButton.textContent = 'Feil!';
                        });
                    });
                    pre.insertBefore(copyButton, pre.firstChild);
                    detailsDiv.appendChild(pre);

                    if (cmd.note) {
                        const note = document.createElement('p');
                        note.id = `cmd-${catIdx}-${cmdIdx}-note`;
                        note.textContent = cmd.note;
                        detailsDiv.appendChild(note);
                    }

                    cmdDiv.appendChild(detailsDiv);
                    cmdDiv.addEventListener('click', function(e) {
                        if (e.target.classList.contains('copy-btn')) return;
                        const details = cmdDiv.querySelector('.details');
                        if (details) {
                            details.classList.toggle('active');
                            document.querySelectorAll('.details.active').forEach(otherDetails => {
                                if (otherDetails !== details) {
                                    otherDetails.classList.remove('active');
                                }
                            });
                        }
                    });
                    catDiv.appendChild(cmdDiv);
                });
                container.appendChild(catDiv);
            });
        }

        // Initielt vis alle
        renderCategories('alle', '');
        libSelect.addEventListener('change', function() {
            renderCategories(libSelect.value, document.getElementById('search-input').value);
        });
        document.getElementById('search-input').addEventListener('input', function() {
            renderCategories(libSelect.value, this.value);
        });
        // Søk-ikon toggle
        const searchIcon = document.getElementById('search-icon');
        const searchInput = document.getElementById('search-input');
        searchIcon.addEventListener('click', function() {
            if (searchInput.style.display === 'none') {
                searchInput.style.display = 'block';
                searchInput.focus();
            } else {
                searchInput.value = '';
                searchInput.style.display = 'none';
                renderCategories(libSelect.value, '');
            }
        });
    });
    </script>
</body>
</html>