<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/style.css">
    <title>Java Kommando Huskeliste</title>
    <link rel="icon" href="./Assets/Logo.png" type="image/png">
</head>
<body class="app-bg">
    <nav aria-label="Tilbake til forsiden">
        <a href="index.html" class="back-link" id="back-link">&larr; Tilbake</a>
    </nav>
    <header>
        <h1 id="page-title">Java Kommando Huskeliste</h1>
    </header>
    <main>
        <section class="topbar" aria-label="Filtrering og søk">
            <div class="topbar-left">
                <label for="lib-select" style="font-weight:bold; color:rgb(41, 219, 219);">Velg kategori:</label>
                <select id="lib-select" aria-label="Velg Java kategori">
                    <option value="alle">Alle</option>
                    <option value="grunnleggende">Grunnleggende</option>
                    <option value="klasser">Klasser</option>
                    <option value="collections">Collections</option>
                    <option value="exceptions">Exceptions</option>
                    <option value="io">I/O</option>
                    <option value="multithreading">Multithreading</option>
                    <option value="streams">Streams</option>
                </select>
            </div>
            <div class="topbar-right">
                <input type="text" id="search-input" placeholder="Søk etter Java..." class="search-input" style="display:none;" aria-label="Søk etter Java kommando">
                <button id="search-icon" aria-label="Søk" class="search-icon-btn">
                    <span id="search-svg" class="search-svg">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                    </span>
                </button>
            </div>
        </section>
        <section id="categories-container" aria-label="Java kommando kategorier"></section>
    </main>
    <footer>
        &copy; TheFrostBunny | <a href="https://github.com/TheFrostBunny" target="_blank" rel="noopener" class="github-link">GitHub</a>
    </footer>
    <script src="/Javascript/script.js"></script>
    <script>
fetch('./Lister/Java.json')
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById('categories-container');
        const libSelect = document.getElementById('lib-select');

        function getCategoryLibrary(cat) {
            const libs = [
                'grunnleggende','klasser','collections','exceptions','io','multithreading','streams'
            ];
            for (const lib of libs) {
                if (cat.name && cat.name.toLowerCase().replace(/[^a-zæøå]/g,'').includes(lib)) return lib;
            }
            return 'grunnleggende';
        }

        function renderCategories(selectedLib, searchText) {
            container.innerHTML = '';
            const search = (searchText || '').toLowerCase();
            data.categories.forEach((cat, catIdx) => {
                const catLib = getCategoryLibrary(cat);
                if (selectedLib !== 'alle' && catLib !== selectedLib) return;
                let commands = cat.commands;
                if (search) {
                    commands = commands.filter(cmd =>
                        (cmd.syntax && cmd.syntax.toLowerCase().includes(search)) ||
                        (cmd.description && cmd.description.toLowerCase().includes(search)) ||
                        (cmd.details && cmd.details.join(' ').toLowerCase().includes(search)) ||
                        (cmd.example && cmd.example.toLowerCase().includes(search))
                    );
                    if (commands.length === 0 && !(cat.name && cat.name.toLowerCase().includes(search))) return;
                }
                const catDiv = document.createElement('div');
                catDiv.className = 'category fade-in';
                const catTitle = document.createElement('h2');
                catTitle.id = `cat-${catIdx}-title`;
                catTitle.textContent = cat.name;
                catDiv.appendChild(catTitle);

                commands.forEach((cmd, cmdIdx) => {
                    const cmdDiv = document.createElement('div');
                    cmdDiv.className = 'command';

                    const code = document.createElement('code');
                    code.id = `cmd-${catIdx}-${cmdIdx}-syntax`;
                    code.textContent = cmd.syntax;
                    cmdDiv.appendChild(code);

                    const desc = document.createElement('div');
                    desc.className = 'description';
                    desc.id = `cmd-${catIdx}-${cmdIdx}-desc`;
                    desc.textContent = cmd.description;
                    cmdDiv.appendChild(desc);

                    const detailsDiv = document.createElement('div');
                    detailsDiv.className = 'details';

                    const detailsTitle = document.createElement('h3');
                    detailsTitle.id = `cmd-${catIdx}-${cmdIdx}-details-title`;
                    detailsTitle.textContent = cmd.detailsTitle || 'Detaljert Forklaring';
                    detailsDiv.appendChild(detailsTitle);

                    const ul = document.createElement('ul');
                    ul.id = `cmd-${catIdx}-${cmdIdx}-details-list`;
                    (cmd.details || []).forEach(d => {
                        const li = document.createElement('li');
                        li.innerHTML = d;
                        ul.appendChild(li);
                    });
                    detailsDiv.appendChild(ul);

                    const exampleTitle = document.createElement('h3');
                    exampleTitle.id = `cmd-${catIdx}-${cmdIdx}-example-title`;
                    exampleTitle.textContent = cmd.exampleTitle || 'Eksempel';
                    detailsDiv.appendChild(exampleTitle);

                    const pre = document.createElement('pre');
                    pre.id = `cmd-${catIdx}-${cmdIdx}-example`;
                    pre.textContent = cmd.example;
                    const copyButton = document.createElement('button');
                    copyButton.className = 'copy-btn';
                    copyButton.textContent = 'Kopier';
                    copyButton.addEventListener('click', function(event) {
                        event.stopPropagation();
                        navigator.clipboard.writeText(cmd.example).then(function() {
                            copyButton.textContent = 'Kopiert!';
                            setTimeout(function() {
                                copyButton.textContent = 'Kopier';
                            }, 2000);
                        }).catch(function() {
                            copyButton.textContent = 'Feil!';
                        });
                    });
                    pre.insertBefore(copyButton, pre.firstChild);
                    detailsDiv.appendChild(pre);

                    if (cmd.note) {
                        const note = document.createElement('p');
                        note.id = `cmd-${catIdx}-${cmdIdx}-note`;
                        note.textContent = cmd.note;
                        note.style.fontStyle = 'italic';
                        note.style.color = 'var(--text-secondary)';
                        detailsDiv.appendChild(note);
                    }

                    cmdDiv.appendChild(detailsDiv);
                    cmdDiv.addEventListener('click', function(e) {
                        if (e.target.classList.contains('copy-btn')) return;
                        const details = cmdDiv.querySelector('.details');
                        if (details) {
                            details.classList.toggle('active');
                            document.querySelectorAll('.details.active').forEach(otherDetails => {
                                if (otherDetails !== details) {
                                    otherDetails.classList.remove('active');
                                }
                            });
                        }
                    });
                    catDiv.appendChild(cmdDiv);
                });
                container.appendChild(catDiv);
            });
        }

        renderCategories('alle', '');
        libSelect.addEventListener('change', function() {
            renderCategories(libSelect.value, document.getElementById('search-input').value);
        });
        document.getElementById('search-input').addEventListener('input', function() {
            renderCategories(libSelect.value, this.value);
        });
        const searchIcon = document.getElementById('search-icon');
        const searchInput = document.getElementById('search-input');
        searchIcon.addEventListener('click', function() {
            if (searchInput.style.display === 'none') {
                searchInput.style.display = 'block';
                searchInput.focus();
            } else {
                searchInput.value = '';
                searchInput.style.display = 'none';
                renderCategories(libSelect.value, '');
            }
        });
    });
    </script>
</body>
</html>